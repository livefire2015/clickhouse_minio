CREATE TABLE default.factTable_join
(
    `index` Int64,
    `int0` Int64,
    `int1` Int64,
    `int2` Int64,
    `int3` Int64,
    `int4` Int64,
    `int5` Int64,
    `int6` Int64,
    `int7` Int64,
    `int8` Int64,
    `int9` Int64,
    `int10` Int64,
    `int11` Int64,
    `int12` Int64,
    `int13` Int64,
    `int14` Int64,
    `int15` Int64,
    `int16` Int64,
    `int17` Int64,
    `int18` Int64,
    `int19` Int64,
    `int20` Int64,
    `int21` Int64,
    `int22` Int64,
    `int23` Int64,
    `int24` Int64,
    `int25` Int64,
    `int26` Int64,
    `int27` Int64,
    `int28` Int64,
    `int29` Int64,
    `int30` Int64,
    `int31` Int64,
    `int32` Int64,
    `int33` Int64,
    `dttime0` DateTime,
    `dttime1` DateTime,
    `dttime2` DateTime,
    `dttime3` DateTime,
    `dttime4` DateTime,
    `dttime5` DateTime,
    `dttime6` DateTime,
    `dttime7` DateTime,
    `dttime8` DateTime,
    `dttime9` DateTime,
    `dttime10` DateTime,
    `dttime11` DateTime,
    `dttime12` DateTime,
    `dttime13` DateTime,
    `dttime14` DateTime,
    `dttime15` DateTime,
    `dttime16` DateTime,
    `dttime17` DateTime,
    `dttime18` DateTime,
    `dttime19` DateTime,
    `dttime20` DateTime,
    `dttime21` DateTime,
    `dttime22` DateTime,
    `dttime23` DateTime,
    `dttime24` DateTime,
    `dttime25` DateTime,
    `dttime26` DateTime,
    `dttime27` DateTime,
    `dttime28` DateTime,
    `dttime29` DateTime,
    `dttime30` DateTime,
    `dttime31` DateTime,
    `dttime32` DateTime,
    `str0` String,
    `str1` String,
    `str2` String,
    `str3` String,
    `str4` String,
    `str5` String,
    `str6` String,
    `str7` String,
    `str8` String,
    `str9` String,
    `str10` String,
    `str11` String,
    `str12` String,
    `str13` String,
    `str14` String,
    `str15` String,
    `str16` String,
    `str17` String,
    `str18` String,
    `str19` String,
    `str20` String,
    `str21` String,
    `str22` String,
    `str23` String,
    `str24` String,
    `str25` String,
    `str26` String,
    `str27` String,
    `str28` String,
    `str29` String,
    `str30` String,
    `str31` String,
    `str32` String,
    `partition` Int64
)
ENGINE = MergeTree()
PARTITION BY partition
ORDER BY tuple()
SETTINGS index_granularity = 8192;

INSERT INTO factTable_join
SELECT COLUMNS('index|int*|dttime*|str*|partition') from factTable;

CREATE TABLE default.factCube (
    index Int64,
    position Int16,
    value Float32
) 
ENGINE = MergeTree()
ORDER BY index;
